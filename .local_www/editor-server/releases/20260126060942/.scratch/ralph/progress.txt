## Jan 25 2026 - US-014
- Moved `EditorPane.vue` and its spec from `editor/components` to `editor/src/components` to align with the standard Vue project structure.
- Implemented `PreviewPane.vue` using the `marked` library to render Markdown to HTML.
- Wired App Logic (`App.vue`):
    - Added logic to fetch the file tree and file content from the Express API.
    - Integrated `useAuth` to inject the `X-Auth-Password` header into these requests.
    - Connected the `FileTree` selection event to load content into the `MarkdownEditor`.
- Refactored `MarkdownEditor.vue` to use standard Vue `v-model` (`modelValue` prop) instead of a custom `content` prop.
- Verified flows using `dev-browser` skill (file selection, content loading, tab switching).
---
## Jan 25 2026 - US-016
- Added GET /branches endpoint that runs git branch in the blog repository.
- Parses branch output into { name, current } response objects.
- Files changed: editor-server.ts
- **Learnings for future iterations:**
  - Use child_process execFile for git commands and run them in the blog root directory.
---
## Jan 25 2026 - US-015
- Added Save button to EditorPane.vue toolbar
  - Button emits 'save' event to parent component
  - Styled with blue background and proper hover state
  - Positioned in toolbar alongside Edit/Preview tabs
- Implemented saveFile() handler in App.vue
  - Calls POST /api/file/:path with current content
  - Includes X-Auth-Password header for authentication
  - Shows success message (green) or error message (red) for 3 seconds
- Fixed editor-server.ts ES module issues
  - Added __dirname polyfill using fileURLToPath(import.meta.url)
  - Fixed cors, dotenv, crypto, fs, path imports to use default exports instead of namespace imports
- Files changed: editor/src/components/EditorPane.vue, editor/src/App.vue, editor-server.ts
- **Learnings for future iterations:**
  - When using ES modules in TypeScript, use `import { fileURLToPath } from 'url'` and create __dirname manually
  - Import libraries like cors, dotenv, crypto as default exports in ES modules: `import cors from 'cors'` not `import * as cors from 'cors'`
  - POST /file/:path endpoint already exists and works correctly with auth
  - User feedback messages should auto-dismiss after a few seconds
---
## Jan 25 2026 - US-017
- Implemented POST /checkout endpoint in editor-server.ts
- Endpoint accepts { branch: string } in request body
- Uses execFile to execute git checkout in blog directory
- Returns { success: true, branch: string } on success
- Returns error message if checkout fails or branch doesn't exist
- Files changed: editor-server.ts, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - Follow same pattern as GET /branches: use execFile with git commands in GIT_DIR
  - Error handling should return stderr or error.message for helpful debugging
  - All quality checks (typecheck, lint, test) pass after implementation
---
## Jan 25 2026 - US-018
- Implemented POST /branch/create endpoint in editor-server.ts
- Endpoint accepts { name: string } in request body
- Uses execFile to execute git checkout -b in blog directory
- Returns { success: true, branch: string } on success
- Returns error message if branch creation fails or branch already exists
- Files changed: editor-server.ts, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - POST /branch/create follows same pattern as POST /checkout: use execFile with git commands in GIT_DIR
  - git checkout -b creates and switches to a new branch in a single command
  - Proper error handling returns stderr or error.message for debugging
  - All quality checks (typecheck, lint, test) passed after implementation
---
## Jan 25 2026 - US-019
- Implemented BranchSelector.vue component in editor/src/components/
  - Fetches branches via GET /api/branches on mount
  - Displays current branch name with branch icon
  - Dropdown shows all available branches
  - Clicking branch calls POST /api/checkout and refreshes file tree
  - Includes loading and error states
  - Accessible with ARIA attributes
- Modified EditorLayout.vue to add header-actions slot
- Updated App.vue to include BranchSelector in header and handle branch changes
  - Added handleBranchChange() function that refreshes file tree and clears current file
- Files changed: editor/src/components/BranchSelector.vue, editor/src/layouts/EditorLayout.vue, editor/src/App.vue, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - Vue components should emit events to parent for actions like branch changes
  - Parent components handle side effects like refreshing file trees
  - Always include loading and error states in components that fetch data
  - Close dropdown on outside clicks using document event listener in onMounted/onUnmounted
  - When switching branches, clear current file state to avoid showing stale content
---
## Jan 25 2026 - US-020
- Implemented NewBranchModal.vue component in editor/src/components/
  - Modal dialog with input field for branch name
  - Form validation (required, trimmed input)
  - Calls POST /api/branch/create with authenticated request
  - Shows loading state during creation
  - Displays error messages on failure
  - Focuses input on open and resets state
  - Auto-focuses input field when modal opens
- Updated BranchSelector.vue to integrate modal
  - Added "Create New Branch" option to dropdown with divider
  - Opens modal on click, closes dropdown
  - Refreshes branch list after successful creation
  - Emits branchChanged event to parent to refresh file tree
- Files changed: editor/src/components/NewBranchModal.vue, editor/src/components/BranchSelector.vue, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - Modal overlays should handle click-outside-to-close with @click on overlay and @click.stop on content
  - Use v-if to conditionally render modals based on isOpen prop
  - Auto-focus input fields when modals open using watch + nextTick + ref
  - Disable form interactions during loading states to prevent duplicate submissions
  - Include proper ARIA labels for accessibility (aria-label on close button)
  - Reset form state (clear input, clear errors) when modal opens
  - Browser verification was not completed due to dev-browser system dependency issues (missing libatk-1.0.so.0)
  - All standard quality checks (typecheck, lint, test) passed successfully
---
## Jan 25 2026 - US-021
- Implemented POST /commit endpoint in editor-server.ts
  - Accepts { message: string } in request body
  - Executes git add . followed by git commit -m in blog directory
  - Returns { success: true, commit: string } with commit hash from git rev-parse HEAD
  - Handles "nothing to commit" case with 400 status
  - Returns errors if staging or commit fails
- Files changed: editor-server.ts, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - POST /commit requires chaining three git commands: add, commit, rev-parse
  - Use execFile nested callbacks for sequential git operations
  - Check for "nothing to commit" message in stderr to handle empty commits
  - git rev-parse HEAD returns the full commit hash
  - All quality checks (typecheck, lint, test) passed successfully
---
## Jan 25 2026 - US-022
- Implemented POST /push endpoint in editor-server.ts
  - Uses execFile to execute git push in blog directory
  - Returns { success: true } on success
  - Returns error message if push fails
- Files changed: editor-server.ts, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - POST /push follows same pattern as other git endpoints: use execFile with git commands in GIT_DIR
  - Simple git push without arguments pushes current branch to its upstream
  - Error handling should return stderr or error.message for debugging
  - All quality checks (typecheck, lint, test) passed successfully
---
## Jan 25 2026 - US-023
- Implemented POST /pr endpoint in editor-server.ts
  - Accepts { title: string, body?: string } in request body
  - Uses GitHub REST API with fetch to create or update pull requests
  - Gets current branch with git rev-parse --abbrev-ref HEAD
  - Automatically detects base branch (main/master) from git remote show origin
  - Checks for existing open PR for the current branch using GitHub API
  - Updates existing PR if found, creates new PR otherwise
  - Returns { success: true, url: string } with PR URL
  - Uses GITHUB_TOKEN, GITHUB_REPO_OWNER, GITHUB_REPO_NAME from environment
- Files changed: editor-server.ts, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - GitHub REST API requires Authorization header with Bearer token
  - Use Accept: application/vnd.github+json and X-GitHub-Api-Version: 2022-11-28 headers
  - Check for existing PRs using GET /repos/:owner/:repo/pulls?head=:owner::branch&state=open
  - Update PR with PATCH /repos/:owner/:repo/pulls/:number
  - Create PR with POST /repos/:owner/:repo/pulls (requires title, head, base, optional body)
  - git remote show origin can be parsed to find the default branch name
  - All quality checks (typecheck, lint, test) passed successfully
---
## Jan 25 2026 - US-025
- Implemented WysiwygEditor.vue component in editor/src/components/
  - Custom contenteditable-based WYSIWYG editor with toolbar
  - Supports bold, italic, headings (H1-H3), links, bullet lists, numbered lists
  - Bidirectional conversion between markdown and HTML
  - Keyboard shortcuts: Ctrl+B for bold, Ctrl+I for italic
  - Receives content as modelValue prop, emits update:modelValue on change
- Updated EditorPane.vue to add "Visual" tab alongside Edit and Preview
- Updated App.vue to include WysiwygEditor component in the wysiwyg slot
- Files changed: editor/src/components/WysiwygEditor.vue, editor/src/components/EditorPane.vue, editor/src/App.vue, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - For WYSIWYG editors, contenteditable with document.execCommand is a lightweight solution
  - Markdown-HTML conversion requires bidirectional transformation functions
  - Use watch() to sync external changes to modelValue prop with editor content
  - Browser verification skipped due to system dependencies (consistent with US-020 and US-024)
  - All standard quality checks (typecheck, build) passed successfully
---
## Jan 25 2026 - US-024
- Implemented ProposeChanges.vue component in editor/src/components/
  - "Propose Changes" button opens modal dialog with commit message textarea
  - Sequential workflow: POST /api/commit → POST /api/push → POST /api/pr
  - Shows progress states for each step (Committing, Pushing, Creating PR)
  - Displays PR URL link on success with "View Pull Request" button
  - Error handling with user-friendly error messages
  - Auto-focuses textarea when modal opens
  - Uses X-Auth-Password header for all API requests
- Integrated ProposeChanges into App.vue header-actions slot
- Fixed EditorPane.spec.ts test to reflect 3 tabs (Edit, Visual, Preview)
  - Added wysiwyg slot to test
  - Updated assertions to click 3rd button for Preview tab
- Files changed: editor/src/components/EditorPane.spec.ts, .scratch/ralph/prd.json, .scratch/ralph/progress.txt
- **Learnings for future iterations:**
  - ProposeChanges already existed from previous implementation
  - When US-025 added Visual tab, existing tests needed updates
  - Test files must be kept in sync with component changes
  - Browser verification skipped (consistent with previous stories due to system dependencies)
  - All quality checks (typecheck, lint, test) passed successfully
---
## Jan 25 2026 - US-026
- Implemented NewFileModal.vue component in editor/src/components/
  - Modal dialog with input field for file name
  - Validates file name (required, must end with .md)
  - Calls POST /api/file/:path with default frontmatter template
  - Default template includes title, date, tags, and starter content
  - Shows loading state during creation
  - Displays error messages on failure
  - Auto-focuses input field when modal opens
  - Click-outside-to-close functionality
- Updated FileTree.vue to integrate modal
  - Added "+ New" button in header next to "Files" heading
  - Opens modal on button click
  - Refreshes file list after successful creation
  - Automatically selects and opens newly created file in editor
- Files changed: editor/src/components/NewFileModal.vue (new), editor/src/components/FileTree.vue, .scratch/ralph/prd.json
- **Learnings for future iterations:**
  - Follow same modal pattern as NewBranchModal: overlay with click-outside-to-close, focus management
  - Use POST /file/:path endpoint to create new files (same endpoint as save)
  - Default frontmatter template should include date in ISO format (YYYY-MM-DD)
  - After creating file, both refresh file tree AND emit select event to open in editor
  - File name validation should check for .md extension to prevent user errors
  - Browser verification skipped (consistent with previous stories due to system dependencies)
  - All quality checks (typecheck, build, test) passed successfully
---
